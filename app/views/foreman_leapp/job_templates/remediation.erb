<%#
kind: job_template
name: Remediation plan
job_category: Leapp
description_format: 'Run Remediation plan with Leapp'
provider_type: SSH
feature: leapp_remediation_plan
template_inputs:
- name: remediation_ids
  required: true
  advanced: true
  input_type: user
  value_type: plain
  description: List of remediation ids
- name: run_preupgrade
  description: Run preupgrade check again when remediation entries are fixed.
  input_type: user
  required: true
  options: "true\nfalse"
  default: "true"
%>

if ! command -v leapp > /dev/null
then
  echo "Leapp is not installed."
  exit 1
fi

<%= build_remediation_plan(input('remediation_ids').split(','), @host) %>
<% if input('run_preupgrade') == 'true' %>
  <%= render_template 'Run preupgrade via Leapp' %>
<% end %>
